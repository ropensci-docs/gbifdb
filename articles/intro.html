<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gbifdb">
<title>Intro to gbifdb • gbifdb</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intro to gbifdb">
<meta property="og:description" content="gbifdb">
<meta property="og:image" content="https://docs.ropensci.org/gbifdb/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">gbifdb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro.html">Intro to gbifdb</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/gbifdb/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Intro to gbifdb</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/gbifdb/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<p>The goal of <code>gbifdb</code> is to provide a relational database interface to a <code>parquet</code> based serializations of <code>gbif</code> data. Instead of requiring custom functions for filtering and selecting data from the central GBIF server (as in <code>rgbif</code>), <code>gbifdb</code> users can take advantage of the full array of <code>dplyr</code> and <code>tidyr</code> functions which can be automatically translated to SQL by <code>dbplyr</code>. Users already familiar with SQL can construct SQL queries directly with <code>DBI</code> instead. <code>gbifdb</code> sends these queries to <a href="https://duckdb.org" class="external-link"><code>duckdb</code></a>, a high-performance, columnar-oriented database engine which runs entirely inside the client, (unlike server-client databases such as MySQL or Postgres, no additional setup is needed outside of installing <code>gbifdb</code>.) <code>duckdb</code> is able to execute these SQL queries directly on-disk against the Parquet data files, side-stepping limitations of available RAM or the need to import the data. It’s highly optimized implementation can be faster even than in-memory operations in <code>dplyr</code>. <code>duckdb</code> supports the full set of SQL instructions, including windowed operations like <code>group_by</code>+<code>summarise</code> as well as table joins.</p>
<p><code>gbifdb</code> has two mechanisms for providing database connections: one which the Parquet snapshot of GBIF must first be downloaded locally, and a second where the GBIF parquet snapshot can be accessed directly from an Amazon Public Data Registry S3 bucket without downloading a copy. The latter approach will be faster for one-off operations and is also suitable when using a cloud-based computing provider in the same region.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p><strong>NOTE</strong>: <code>gbifdb</code> currently requires the dev version of <code>duckdb</code>, which you can install using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"https://github.com/duckdb/duckdb/releases/download/master-builds/duckdb_r_src.tar.gz"</span>, repos <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<!--

You can install the released version of `gbifdb` from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("gbifdb")
```

-->
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"cboettig/gbifdb"</span><span class="op">)</span></span></code></pre></div>
<p><code>gbifdb</code> has few dependencies: only <code>duckdb</code> and <code>DBI</code> are required.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/gbifdb/">gbifdb</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>  <span class="co"># optional, for dplyr-based operations</span></span></code></pre></div>
<div class="section level3">
<h3 id="remote-data-access">Remote data access<a class="anchor" aria-label="anchor" href="#remote-data-access"></a>
</h3>
<p>To begin working with GBIF data directly without downloading the data first, simply establish a remote connection using <code><a href="../reference/gbif_remote.html">gbif_remote()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gbif_remote.html">gbif_remote</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can now perform most <code>dplyr</code> operations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phylum</span> <span class="op">==</span> <span class="st">"Chordata"</span>, <span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1990</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">class</span>, <span class="va">year</span><span class="op">)</span></span>
<span><span class="co">#&gt; FileSystemDataset (query)</span></span>
<span><span class="co">#&gt; class: string</span></span>
<span><span class="co">#&gt; year: int32</span></span>
<span><span class="co">#&gt; n: int32</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Grouped by class</span></span>
<span><span class="co">#&gt; See $.data for the source Arrow object</span></span></code></pre></div>
<p>By default, this relies on an <code>arrow</code> connection, which currently lacks support for some more complex windowed operations in <code>dplyr</code>. A user can specify the option <code>to_duckdb = TRUE</code> in <code><a href="../reference/gbif_remote.html">gbif_remote()</a></code> (or simply pass the connection to <code><a href="https://arrow.apache.org/docs/r/reference/to_duckdb.html" class="external-link">arrow::to_duckdb()</a></code>) to create a <code>duckdb</code> connection. This is slightly slower at this time. Keep in mind that as with any database connection, to use non-<code>dplyr</code> functions the user will generally need to call <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">dplyr::collect()</a></code>, which pulls the data into working memory.<br>
Be sure to subset the data appropriately first (e.g. with <code>filter</code>, <code>summarise</code>, etc), as attempting to <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect()</a></code> a large table will probably exceed available RAM and crash your R session!</p>
<p>When using a <code><a href="../reference/gbif_remote.html">gbif_remote()</a></code> connection, all I/O operations will be conducted over the network storage instead of your local disk, without downloading the full dataset first. These operations will be considerably slower than they would be if you download the entire dataset first (see below, unless you are on an AWS cloud instance in the same region as the remote host), but this does avoid the download step all-together, which may be necessary if you do not have 100+ GB free storage space or the time to download the whole dataset first (e.g. for one-off queries).</p>
</div>
<div class="section level3">
<h3 id="local-data">Local data<a class="anchor" aria-label="anchor" href="#local-data"></a>
</h3>
<p>For extended analysis of GBIF, users may prefer to download the entire GBIF parquet data first. This requires over 100 GB free disk space, and will be a time-consuming process the first time. However, once downloaded, future queries will run much much faster, particularly if you are network-limited. Users can download the current release of GBIF to local storage like so:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gbif_download.html">gbif_download</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>By default, this will download to the dir given by <code><a href="../reference/gbif_dir.html">gbif_dir()</a></code>.<br>
An alternative directory can be set as an argument, or by setting the path in the environmental variable, <code>GBIF_HOME</code>.</p>
<p>Once you have downloaded the parquet-formatted GBIF data, simply point <code>gbif_conn()</code> at the directory containing your parquet files to initialize a connection. (By default, <code>gbif_conn()</code> will look for data in the configurable directory given by <code><a href="../reference/gbif_dir.html">gbif_dir()</a></code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu">gbif_conn</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The resulting connection can be used with <code><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">dplyr::tbl()</a></code> to access the full gbif data:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"gbif"</span><span class="op">)</span></span>
<span><span class="va">gbif</span></span>
<span><span class="co">#&gt; # Source:   table&lt;gbif&gt; [?? x 50]</span></span>
<span><span class="co">#&gt; # Database: duckdb_connection</span></span>
<span><span class="co">#&gt;        gbifid datasetkey  occurrenceid   kingdom phylum class order family genus</span></span>
<span><span class="co">#&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 1851456555 b234abf6-4… 03871B11FFA43… Animal… Echin… Holo… Dend… Cucum… Acti…</span></span>
<span><span class="co">#&gt;  2 1851456618 b234abf6-4… 03871B11FFAA3… Animal… Echin… Holo… Dend… Scler… Clad…</span></span>
<span><span class="co">#&gt;  3 1851456554 b234abf6-4… 03871B11FFA53… Animal… Echin… Holo… Dend… Cucum… Acti…</span></span>
<span><span class="co">#&gt;  4 1851456620 b234abf6-4… 03871B11FFA03… Animal… Echin… Holo… Dend… Phyll… Tria…</span></span>
<span><span class="co">#&gt;  5 1851456556 b234abf6-4… 03871B11FFA83… Animal… Echin… Holo… Dend… Scler… Glob…</span></span>
<span><span class="co">#&gt;  6 1851456619 b234abf6-4… 03871B11FFA33… Animal… Echin… Holo… Dend… Phyll… Mass…</span></span>
<span><span class="co">#&gt;  7 1851456623 b234abf6-4… 03871B11FFA03… Animal… Echin… Holo… Dend… Phyll… Tria…</span></span>
<span><span class="co">#&gt;  8 1851456714 b234abf6-4… 03871B11FFAC3… Animal… Echin… Holo… Dend… Phyll… Mass…</span></span>
<span><span class="co">#&gt;  9 1851456553 b234abf6-4… 03871B11FFAA3… Animal… Echin… Holo… Dend… Scler… Clad…</span></span>
<span><span class="co">#&gt; 10 1851456622 b234abf6-4… 03871B11FFA53… Animal… Echin… Holo… Dend… Cucum… Acti…</span></span>
<span><span class="co">#&gt; # … with more rows, and 41 more variables: species &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   infraspecificepithet &lt;chr&gt;, taxonrank &lt;chr&gt;, scientificname &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   verbatimscientificname &lt;chr&gt;, verbatimscientificnameauthorship &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   countrycode &lt;chr&gt;, locality &lt;chr&gt;, stateprovince &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   occurrencestatus &lt;chr&gt;, individualcount &lt;int&gt;, publishingorgkey &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   decimallatitude &lt;dbl&gt;, decimallongitude &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   coordinateuncertaintyinmeters &lt;dbl&gt;, coordinateprecision &lt;dbl&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gbif</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "gbifid"                           "datasetkey"                      </span></span>
<span><span class="co">#&gt;  [3] "occurrenceid"                     "kingdom"                         </span></span>
<span><span class="co">#&gt;  [5] "phylum"                           "class"                           </span></span>
<span><span class="co">#&gt;  [7] "order"                            "family"                          </span></span>
<span><span class="co">#&gt;  [9] "genus"                            "species"                         </span></span>
<span><span class="co">#&gt; [11] "infraspecificepithet"             "taxonrank"                       </span></span>
<span><span class="co">#&gt; [13] "scientificname"                   "verbatimscientificname"          </span></span>
<span><span class="co">#&gt; [15] "verbatimscientificnameauthorship" "countrycode"                     </span></span>
<span><span class="co">#&gt; [17] "locality"                         "stateprovince"                   </span></span>
<span><span class="co">#&gt; [19] "occurrencestatus"                 "individualcount"                 </span></span>
<span><span class="co">#&gt; [21] "publishingorgkey"                 "decimallatitude"                 </span></span>
<span><span class="co">#&gt; [23] "decimallongitude"                 "coordinateuncertaintyinmeters"   </span></span>
<span><span class="co">#&gt; [25] "coordinateprecision"              "elevation"                       </span></span>
<span><span class="co">#&gt; [27] "elevationaccuracy"                "depth"                           </span></span>
<span><span class="co">#&gt; [29] "depthaccuracy"                    "eventdate"                       </span></span>
<span><span class="co">#&gt; [31] "day"                              "month"                           </span></span>
<span><span class="co">#&gt; [33] "year"                             "taxonkey"                        </span></span>
<span><span class="co">#&gt; [35] "specieskey"                       "basisofrecord"                   </span></span>
<span><span class="co">#&gt; [37] "institutioncode"                  "collectioncode"                  </span></span>
<span><span class="co">#&gt; [39] "catalognumber"                    "recordnumber"                    </span></span>
<span><span class="co">#&gt; [41] "identifiedby"                     "dateidentified"                  </span></span>
<span><span class="co">#&gt; [43] "license"                          "rightsholder"                    </span></span>
<span><span class="co">#&gt; [45] "recordedby"                       "typestatus"                      </span></span>
<span><span class="co">#&gt; [47] "establishmentmeans"               "lastinterpreted"                 </span></span>
<span><span class="co">#&gt; [49] "mediatype"                        "issue"</span></span></code></pre></div>
<p>Now, we can use <code>dplyr</code> to perform standard queries:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">growth</span> <span class="op">&lt;-</span> <span class="va">gbif</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phylum</span> <span class="op">==</span> <span class="st">"Chordata"</span>, <span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1990</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">class</span>, <span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="va">growth</span></span>
<span><span class="co">#&gt; # Source:     lazy query [?? x 3]</span></span>
<span><span class="co">#&gt; # Database:   duckdb_connection</span></span>
<span><span class="co">#&gt; # Groups:     class</span></span>
<span><span class="co">#&gt; # Ordered by: year</span></span>
<span><span class="co">#&gt;    class               year       n</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Aves                1991 3183184</span></span>
<span><span class="co">#&gt;  2 Mammalia            1991  100931</span></span>
<span><span class="co">#&gt;  3 Actinopterygii      1991  363791</span></span>
<span><span class="co">#&gt;  4 Amphibia            1991   18443</span></span>
<span><span class="co">#&gt;  5 Reptilia            1991   29806</span></span>
<span><span class="co">#&gt;  6 Elasmobranchii      1991   17521</span></span>
<span><span class="co">#&gt;  7 Holocephali         1991    1048</span></span>
<span><span class="co">#&gt;  8 Cephalaspidomorphi  1991    1152</span></span>
<span><span class="co">#&gt;  9 Thaliacea           1991     669</span></span>
<span><span class="co">#&gt; 10 Sarcopterygii       1991      13</span></span>
<span><span class="co">#&gt; # … with more rows</span></span></code></pre></div>
<p>Recall that when database connections in <code>dplyr</code>, the data remains in the database (i.e. on disk, not in working RAM).<br>
This is fine for any further operations using <code>dplyr</code>/<code>tidyr</code> functions which can be translated into SQL.<br>
Using such functions we can usually reduce our resulting table to something much smaller, which can then be pulled into memory in R for further analysis using <code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GBIF: the global bird information facility?</span></span>
<span><span class="va">growth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu">fct_lump_n</span><span class="op">(</span><span class="va">class</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">year</span>, <span class="va">n</span>, fill<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"GBIF observations by class"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
